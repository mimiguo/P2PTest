<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   xmlns:mvcs="robotlegs.bender.bundles.mvcs.*"
			   xmlns:rl2="http://ns.robotlegs.org/flex/rl2"
			   xmlns:views="robotlegs.bender.P2PTest.views.*"
			   xmlns:config="robotlegs.bender.P2PTest.config.*"
			   width="1000" height="1000"
			   >
	<fx:Declarations>
		<rl2:ContextBuilder>
			<mvcs:MVCSBundle/>
			<config:P2ptestConfig/>
		</rl2:ContextBuilder>
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import mx.core.UIComponent;
			import com.adobe.viewsource.ViewSource;
			import org.osmf.events.*;
			import mx.utils.ObjectUtil;
			import robotlegs.bender.P2PTest.models.vo.PostMsg;
			
			private var netGroup : NetGroup;
			private var joinGroup:Boolean = false;
			private var sequenceNumber:int = 0;
			
			private function pushMsg(msg:String) : void
			{
				testConnection.msg_ta.appendText(msg+"\n");
			}
			
			private function post(e:MouseEvent) : void
			{
				if ( joinGroup ) {
					var msg:robotlegs.bender.P2PTest.models.vo.PostMsg = new PostMsg();
					msg.user = user_ti.text;
					msg.text = chat_ti.text;
					msg.sequence = sequenceNumber++;
//					msg.sender = netConnection.nearID; 
					netGroup.post(msg);
				}
				chat_ti.text = "";
			}
			
			private function checkGroupString() :void
			{
				var g:GroupSpecifier = new GroupSpecifier(checkGroupspec.chk_groupName_ti.text);
				if ( checkGroupspec.p2p_cb.selected) {
					g.peerToPeerDisabled = true;						
				}
				if (checkGroupspec.password.text != "") {
					g.setPublishPassword(checkGroupspec.password.text);
				}
				/* if ( checkGroupspec.unigue_cb.selected ) {
					g.makeUnique();
				} */
				checkGroupspec.gstring_ta.text = 'groupspecWithAuthorizations:'+g.groupspecWithAuthorizations()+'\ngroupspecWithoutAuthorizations:'+g.groupspecWithoutAuthorizations();
				checkGroupspec.gstring_ta.text += '\ntostring:'+g.toString();
			}
		]]>
	</fx:Script>
	<s:VGroup x="5" y="5">
		<s:HGroup>
			<views:TestConnection id="testConnection"></views:TestConnection>
			<views:CheckGroupspec id="checkGroupspec"></views:CheckGroupspec>
		</s:HGroup>
		<s:Label text="test pass message within group"/>
		<s:TextInput id="user_ti" width="500" text="gabe"/>
		<s:TextInput id="chat_ti" width="500" text="chat message"/>
		<s:Button id="post_btn" label="post" click="post(event)" />
		<views:Player/>
	</s:VGroup>
</s:Application>